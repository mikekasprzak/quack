# - ------------------------------------------------------------------------ - #
ROOT_DIR			:=	C:/Nintendo/armcc_4_1
BIN_DIR				:=	$(ROOT_DIR)/bin
# - ------------------------------------------------------------------------ - #
CC					:=	$(BIN_DIR)/armcc
CXX					:=	$(BIN_DIR)/armcc
LD					:=	$(BIN_DIR)/armlink
# - ------------------------------------------------------------------------ - #
LM_LICENSE_FILE		=	C:/Nintendo/armcc_4_1/nintendo-anyhost.lic
# - ------------------------------------------------------------------------ - #
INCLUDES			+=	-JC:/Nintendo/CTR_SDK/include \
						-JC:/Nintendo/armcc_4_1/include \
# - ------------------------------------------------------------------------ - #
LIBRARIES			+=	
# - ------------------------------------------------------------------------ - #
LDFLAGS				+=	--libpath C:/Nintendo/CTR_SDK/libraries/CTR-TS.Process.MPCore \
						--libpath C:/Nintendo/armcc_4_1/lib \
# - ------------------------------------------------------------------------ - #

# - ------------------------------------------------------------------------ - #
CFLAGS				+=	--gnu
CPPFLAGS			+=	--gnu
# - ------------------------------------------------------------------------ - #

# - ------------------------------------------------------------------------ - #
# Release Build Only #
# - ------------------------------------------------------------------------ - #
ifdef NDEBUG
DEFINES				+=	NDEBUG
LDFLAGS				+=	
# - ------------------------------------------------------------------------ - #
else
# - ------------------------------------------------------------------------ - #
DEFINES				+=	
CFLAGS				+=	-g
CPPFLAGS			+=	-g
# - ------------------------------------------------------------------------ - #
endif # NDEBUG #
# - ------------------------------------------------------------------------ - #


# - ------------------------------------------------------------------------ - #
ifdef OSIZE # Optimized for Size #
# - ------------------------------------------------------------------------ - #
CFLAGS				+=	-Ospace
CPPFLAGS			+=	-Ospace
# - ------------------------------------------------------------------------ - #
else ifdef O3 # Optimized for Space #
# - ------------------------------------------------------------------------ - #
CFLAGS				+=	-O3
CPPFLAGS			+=	-O3
# - ------------------------------------------------------------------------ - #
else ifdef O0 # No Optimizations #
# - ------------------------------------------------------------------------ - #
CFLAGS				+=	-O0
CPPFLAGS			+=	-O0
# - ------------------------------------------------------------------------ - #
else # Default #
# - ------------------------------------------------------------------------ - #
CFLAGS				+=	-O0
CPPFLAGS			+=	-O0
# - ------------------------------------------------------------------------ - #
endif # Optimizations #
# - ------------------------------------------------------------------------ - #


# - ------------------------------------------------------------------------ - #
$(TARGET): $(TARGET_STUBS) $(FOLDER_STUBS) $(H_FILES) $(.O_FILES) $(OTHER_FILES_DEP) startcache
	$(LD) $(LDFLAGS) $(OTHER_O_FILES) $(.O_FILES) -o $@ $(LIBRARIES)
# - ------------------------------------------------------------------------ - #

# - ------------------------------------------------------------------------ - #
# The below 2 cause a conflict with the -include in common_makefile. #
# - ------------------------------------------------------------------------ - #
obj/$(TARGET_NAME)/%.c.o: %.c
	$(CC) $(DEFINES) $(INCLUDES) $(CFLAGS) --depend=$@.d --depend-format=unix --no_depend_system_headers -c $< -o $@
# - ------------------------------------------------------------------------ - #
obj/$(TARGET_NAME)/%.cpp.o: %.cpp
	$(CXX) $(DEFINES) $(INCLUDES) $(CPPFLAGS) --depend=$@.d --depend-format=unix --no_depend_system_headers -c $< -o $@
# - ------------------------------------------------------------------------ - #
