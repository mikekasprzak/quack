# - ------------------------------------------------------------------------ - #
CC					:=	emcc
CXX					:=	em++
LD					:=	emld
# - ------------------------------------------------------------------------ - #


# - ------------------------------------------------------------------------ - #
# Release Build Only #
# - ------------------------------------------------------------------------ - #
ifdef NDEBUG
DEFINES				+=	NDEBUG
LDFLAGS				+=	-s
# - ------------------------------------------------------------------------ - #
else
# - ------------------------------------------------------------------------ - #
DEFINES				+=	
CFLAGS				+=	-g
CPPFLAGS			+=	-g
# - ------------------------------------------------------------------------ - #
endif # NDEBUG #
# - ------------------------------------------------------------------------ - #


# - ------------------------------------------------------------------------ - #
ifdef OSIZE # Optimized for Size #
# - ------------------------------------------------------------------------ - #
CFLAGS				+=	-Os
CPPFLAGS			+=	-Os
# - ------------------------------------------------------------------------ - #
else ifdef O3 # Optimized for Space #
# - ------------------------------------------------------------------------ - #
CFLAGS				+=	-O3
CPPFLAGS			+=	-O3
# - ------------------------------------------------------------------------ - #
else ifdef O0 # No Optimizations #
# - ------------------------------------------------------------------------ - #
CFLAGS				+=	-O0
CPPFLAGS			+=	-O0
# - ------------------------------------------------------------------------ - #
else # Default #
# - ------------------------------------------------------------------------ - #
CFLAGS				+=	-O0
CPPFLAGS			+=	-O0
# - ------------------------------------------------------------------------ - #
endif # Optimizations #
# - ------------------------------------------------------------------------ - #


# - ------------------------------------------------------------------------ - #
$(TARGET): $(TARGET_STUBS) $(FOLDER_STUBS) $(H_FILES) $(.O_FILES) $(OTHER_FILES_DEP) startcache
ifneq ($(strip $(COPY_FILES)),)
	cp -t $(TARGET_DIR) $(COPY_FILES)
endif
	$(CXX) $(DEFINES) $(LDFLAGS) $(OTHER_O_FILES) $(.O_FILES) -o $@ $(LIBRARIES)
# - ------------------------------------------------------------------------ - #

# - ------------------------------------------------------------------------ - #
obj/$(TARGET_NAME)/%.c.o: %.c
	$(CC) $(DEFINES) $(INCLUDES) $(CFLAGS) -c $< -o $@
# - ------------------------------------------------------------------------ - #
obj/$(TARGET_NAME)/%.cpp.o: %.cpp
	$(CXX) $(DEFINES) $(INCLUDES) $(CPPFLAGS) -c $< -o $@
# - ------------------------------------------------------------------------ - #
